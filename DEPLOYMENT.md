# PsyDream: Руководство по развертыванию (Deployment Guide)

Это руководство описывает процесс развертывания приложения **PsyDream** на хостинг Vercel с использованием сборщика Vite.

---

## 1. Подготовка к Деплою (Vercel)

### Шаг 1.1. Настройка проекта
При импорте репозитория в Vercel:
1.  **Framework Preset**: Выберите **Vite**.
2.  **Root Directory**: Оставьте `./` (если файлы в корне).

### Шаг 1.2. Переменные Окружения (Environment Variables)
Это критически важный шаг. Без него ИИ не будет работать.

1.  Перейдите в **Settings** -> **Environment Variables**.
2.  Добавьте переменную:
    *   **Key**: `VITE_API_KEY`
    *   **Value**: Ваш ключ от Google AI Studio (`AIzaSy...`).
    *   *Важно:* Имя должно начинаться с `VITE_`, иначе приложение его не увидит.

---

## 2. Устранение частых проблем

### Проблема: "Черный экран" при открытии сайта
Если после деплоя сайт открывается пустым:
1.  **Причина**: Vite требует явного подключения скрипта в `index.html`.
2.  **Решение**: Убедитесь, что в `index.html` перед закрывающим тегом `</body>` есть строка:
    ```html
    <script type="module" src="/index.tsx"></script>
    ```
3.  **Причина 2**: Ошибка доступа к `process.env`.
4.  **Решение**: В коде используется безопасная функция `getApiKey`, которая проверяет `import.meta.env`. Убедитесь, что вы не используете прямой доступ к `process` в глобальной области видимости.

### Проблема: Ошибка 429 (Quota Exceeded)
Если вы видите "Resource Exhausted":
1.  **Причина**: Модель `gemini-3-pro` недоступна или имеет нулевые лимиты на бесплатном тарифе.
2.  **Решение**: В файле `services/geminiService.ts` мы переключились на **`gemini-2.5-flash`**. Она быстрая и имеет высокие лимиты (15 RPM).

### Проблема: Ошибка генерации изображений (404 Not Found)
1.  **Причина**: Модель `imagen-3.0` часто закрыта для публичного доступа.
2.  **Решение**: Используйте модель **`gemini-2.0-flash-exp`** с методом `generateContent`.

---

## 3. Архитектура Безопасности (Production)

⚠️ **ВНИМАНИЕ:** В текущей версии API-ключ используется на **клиенте (Frontend)**. Это допустимо для личных проектов или прототипов на Vercel, но небезопасно для коммерческого запуска.

### Почему это риск?
Любой посетитель сайта может найти ваш `VITE_API_KEY` в сетевых запросах браузера.

### Рекомендуемое решение для PRO-версии:
Создайте промежуточный Бэкенд (Proxy Server).

**Схема:**
`Client (PsyDream)` -> `Ваш Сервер (Node.js/Next.js API)` -> `Google Gemini`

1.  Создайте API Route (например, в Next.js `/api/analyze`).
2.  Переместите `GoogleGenAI` инициализацию на сервер.
3.  Храните ключ в серверных переменных (без префикса `VITE_`).
4.  Клиент делает запрос к вашему серверу, а не к Google напрямую.

---

## 4. Локальная разработка

Для запуска на компьютере:
1.  Создайте файл `.env` в корне проекта.
2.  Добавьте строку: `VITE_API_KEY=AIzaSy...`
3.  Запустите: `npm run dev`
